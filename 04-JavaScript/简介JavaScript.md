# 简介JavaScript

## 解释代码 vs 编译代码

作为程序员，你或许听说过这两个术语：解释（interpret）和编译（compile）。

- 在解释型语言中，**代码自上而下运行**，**且实时返回运行结果**。代码在由浏览器执行前，不需要将其转化为其他形式。代码将直接以文本格式被接收和处理。

- 编译型语言需要先将代码转化（编译）成另一种形式才能运行。比如 C/C++ 先被编译成机器码，然后才能由计算机运行。程序将以二进制的格式运行，这些二进制内容是由程序源代码产生的。

**`JavaScript` 是轻量级解释型语言**。浏览器接受到 `JavaScript` 代码，并以代码自身的文本格式运行它。技术上，几乎所有 `JavaScript` 转换器都运用了一种叫做即时编译（just-in-time compiling）的技术；当 `JavaScript` 源代码被执行时，它会被编译成二进制的格式，使代码运行速度更快。尽管如此，JavaScript 仍然是一门解释型语言，因为编译过程发生在代码运行中，而非之前。

## 服务器端代码 vs 客户端代码

你或许还听说过服务器端（server-side）和客户端（client-side）代码这两个术语，尤其是在 web 开发时。

- **客户端代码是在用户的电脑上运行的代码**，**在浏览一个网页时，它的客户端代码就会被下载，然后由浏览器来运行并展示**。在本模块中我们讨论的主要是客户端 JavaScript。

- 而服务器端代码在服务器上运行，然后运行结果才由浏览器下载并展示出来。流行的服务器端 web 语言包括：PHP、Python、Ruby、ASP.NET，甚至有 JavaScript！**JavaScript 也可用作服务器端语言**，**比如现在流行的 `Node.js` 环境**，你可以在我们的动态网页——服务器端编程主题中找到更多关于服务器端 JavaScript 的知识。

## 动态代码 vs 静态代码

- 动态一词既适用于客户端 JavaScript，又适用于描述服务器端语言。它是指通过按需生成新内容来更新 web 页面或应用，使得不同环境下可以显示出不同内容。服务器端代码会在服务器上动态生成新内容，例如从数据库中提取信息。而客户端 JavaScript 则在用户端浏览器中动态生成新内容，例如创建一个新的 HTML 表格，用从服务器请求到的数据填充，然后在网页中向用户展示这个表格。两种情况的意义略有不同，但又有所关联，且两者（服务器端和客户端）经常协同工作。

- 没有动态更新内容的网页叫做静态页面，所显示的内容不会改变。

## 怎样向页面添加 JavaScript？

```html
// 在html 内部直接写js
<script>
  // 在此编写 JavaScript 代码
</script>
```

```html
// 引入js
<script src="javascript.js" defer></script>
```

## 加载顺序-脚本调用策略

若 JavaScript 加载于欲操作的 HTML 元素之前。

内部

```js
//这是一个事件监听器，它监听浏览器的 DOMContentLoaded 事件，其标志了 HTML 文档体完全加载和解析。
//该代码块中的 JavaScript 在事件被触发后才会运行，因此避免了错误
document.addEventListener("DOMContentLoaded", () => {
  // …
});
```

外部

```js
// 使用了 JavaScript 的一项现代技术（defer 属性）来解决这一问题
// 它告知浏览器在遇到 <script> 元素时继续下载 HTML 内容。
// defer 只适用于外部脚本
<script src="script.js" defer></script>
```

旧的方法

把脚本元素放在文档体的底端（也就是 `</body>` 标签之前，与之相邻），这样脚本就可以在 HTML 解析完毕后加载了。

此方案的问题是：只有在所有 `HTML DOM` 加载完成后才开始脚本的加载/解析过程。对于有大量 JavaScript 代码的大型网站，可能会带来显著的性能损耗。

### async 和 defer

```html
<!-- 三者的调用顺序是不确定的。jquery.js 可能在 script2 和 script3 之前或之后调用，
如果这样，后两个脚本中依赖 jquery 的函数将产生错误，因为脚本运行时 jquery 尚未加载。 -->
<script async src="js/vendor/jquery.js"></script>

<script async src="js/script2.js"></script>

<script async src="js/script3.js"></script>
```

`async` 应该在有大量后台脚本需要加载，并且只想尽快加载到位的情况下使用。例如，你可能需要加载一些游戏数据文件，这在游戏真正开始时是需要的，但现在你只想显示游戏介绍、标题和大厅，而不想被脚本加载阻塞。

```html
<!-- 脚本将按照在页面中出现的顺序加载和运行：
因此第二个示例可确保 jquery.js 必定加载于 script2.js 和 script3.js 之前，同时 script2.js 必定加载于 script3.js 之前。-->
<script defer src="js/vendor/jquery.js"></script>

<script defer src="js/script2.js"></script>

<script defer src="js/script3.js"></script>
```

在页面内容全部加载完成之前，它们不会运行，如果你的脚本依赖于 DOM 的存在（例如，它们修改了页面上的一个或多个元素），这将非常有用。

**脚本调用策略小结**：

- `async` 和 `defer` 都指示浏览器**在一个单独的线程中下载脚本**，而页面的其他部分（DOM 等）正在下载，因此**在获取过程中页面加载不会被阻塞**。
- `async` 属性的脚本将在**下载完成后立即执行**。这将**阻塞页面，并不保证任何特定的执行顺序**。
- 带有 `defer` 属性的脚本将按照它们的**顺序加载**，并且只有**在所有脚本加载完毕后才会执行**。
- **如果脚本无需等待页面解析，且无依赖独立运行**，那么应使用 `async`。
- **如果脚本需要等待页面解析，且依赖于其他脚本**，调用这些脚本时应使用 `defer`，将关联的脚本按所需顺序置于 HTML 的相应 `<script>` 元素中。

## js 注释

```js
// 我是一条注释
/*
  一般来说，注释越多越好，
  但如果你发现自己添加了大量注释来解释变量是什么（变量名也许应该更直观），
  或者解释非常简单的操作（也许代码过于复杂），那么就应该小心了。
*/
```
